<!DOCTYPE html>
<html>
  <head>
  <title>Junk Drawer : Ruby, where are you (in GitHub workflows)?</title>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  <!-- link to main stylesheet -->
  <link rel="stylesheet" type="text/css" href="https://benknoble.github.io/assets/css/styles.css" media="screen">

  <script src="/assets/js/scale.fix.js"></script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" >
  </script>

  <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/assets/img/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link type="application/atom+xml" rel="alternate" href="https://benknoble.github.io/feed.xml" title="Junk Drawer" />
</head>

  <body>
    <header>
  <h1>
  <a href="https://benknoble.github.io/">
  <img src='/assets/img/logo.png' alt='Junk Drawer Logo' width=32 height=32> Junk Drawer</a></h1>
  <p>For all those little papers scattered across your desk</p>
</header>

    <section>
      <p>
      I stand for the Constitution, for due process, and for community that
      takes care of each other.
      </p>
      <nav>
  <ul>
    
    <li class="">
      <a href="https://benknoble.github.io/about/">About</a>
    </li>
    
    <li class="">
      <a href="https://benknoble.github.io/categories/">Posts</a>
    </li>
    
    <li class="">
      <a href="https://benknoble.github.io/workshops/">Workshops</a>
    </li>
    
    <li class="">
      <a href="https://benknoble.github.io/papers/">Papers</a>
    </li>
    
    <li class="">
      <a href="https://benknoble.github.io/writings/">Writings</a>
    </li>
    
    <li class="">
      <a href="https://benknoble.github.io/reading/">Reading List</a>
    </li>
    
  </ul>
</nav>

      <h1>Ruby, where are you (in GitHub workflows)?</h1>
      <p class="meta"><span class="authors">
  
  
    D. Ben Knoble
  
</span>
 on 13 Aug 2019 in Blog</p>
<div id="post">
  <p>A treasure hunt for ruby in the beta of GitHub actions and workflows leaves me
scratching my head…</p>

<p>GitHub recently opened up the workflows/actions to a public beta, and I’m in it.</p>

<blockquote>
  <p>Aside: A <em>workflow</em> is the <code class="language-plaintext highlighter-rouge">.github/workflows/*.yml</code> file that contains the
actual workflow, while an <em>action</em> is more nebulous (Docker stuff, repos,
etc.). This naming overlap makes it difficult to talk about, so I’ll stick to
workflow.</p>
</blockquote>

<p>I went through all my repos and decided to setup CI workflows for each one. I
may add other things later, like stale-issue-organizers or deployment workflows,
but I wanted to start simple.</p>

<p>And then I did my <a href="https://github.com/benknoble/Dotfiles">Dotfiles</a>.</p>

<h2 id="results">Results</h2>

<p>For the interested, it ended up being a great way to check the compatibility of
my dotfiles across Mac and Ubuntu. I ended up finding and fixing several bugs,
and I’m glad I have this now.</p>

<p>However, there was one big hiccup, and I’ve documented it for you in all it’s
glory: <a href="https://github.com/benknoble/Dotfiles/commits/ruby-where-are-you">ruby, where are
you?</a>.</p>

<h3 id="needing-ruby">Needing Ruby</h3>

<p>I need ruby because I need to run some downloaded ruby code to install brew as
part of the <code class="language-plaintext highlighter-rouge">make install</code> process of my dotfiles:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/bin/ruby -e "$( curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install )"
/bin/sh: 1: /usr/bin/ruby: not found
Makefile:56: recipe for target 'brew_install' failed
make: *** [brew_install] Error 127
</code></pre></div></div>

<p>But as you can see, ruby is nowhere to be found.</p>

<blockquote>
  <p>Aside: There are other issues with that line of code; namely, we need
LinuxBrew on Ubuntu instead of Homebrew, and not all rubies are
<code class="language-plaintext highlighter-rouge">/usr/bin/ruby</code>. These have since been corrected.</p>
</blockquote>

<h3 id="it-exists">It exists…</h3>

<p>I was <em>baffled</em>. <a href="https://help.github.com/en/articles/software-in-virtual-environments-for-github-actions">Ruby is provided in all the
environments</a>!</p>

<h3 id="treasure-hunt">Treasure Hunt</h3>

<p>Flummoxed, I spent hours <a href="https://github.com/benknoble/Dotfiles/commits/ruby-where-are-you">crafting commits to find a ruby executable</a>. I
was largely unsuccessful, and eventually filed a GitHub support request.</p>

<blockquote>
  <p>Aside: I’ve done one of those before, but it seemed like they had a whole
forum system, and now it’s just a little email. I can’t find any kind of
forum, and I have no response from them at this time (beyond confirmation of
receipt). If anyone knows what happened to the forums or where they are,
please comment below.</p>
</blockquote>

<p>Here’s some logs for you: <a href="https://gist.github.com/benknoble/126bce506f2326b17cdef0402bf78fa0">a
gist</a>.</p>

<p>Then, I discovered <a href="https://github.com/benknoble/Dotfiles/commit/d49f2ff86326628aa8fc52f0ae1b7eccbfdbbc5a">this little
gem</a>.
It’s <a href="https://github.com/benknoble/Dotfiles/commit/bcbf971e679b96f7cfa71f635b31771b87aaad31">still not quite
perfect</a>,
but somehow in reading all of the documentation it was never mentioned that
common environments (node, python, ruby) need setup actions.</p>

<p>So, when you need ruby for a GitHub workflow:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-ruby@v1</span>
  <span class="na">with</span><span class="pi">:</span>
    <span class="na">ruby-version</span><span class="pi">:</span> <span class="s">2.6.x</span>
</code></pre></div></div>


</div>
<hr/>
<h4>Tags:</h4>
<ul class="tags">
  
    <li>
      <a href="https://benknoble.github.io/tags#git" class="tag">
        git
      </a>
    </li>
  
    <li>
      <a href="https://benknoble.github.io/tags#github" class="tag">
        github
      </a>
    </li>
  
    <li>
      <a href="https://benknoble.github.io/tags#github-workflow" class="tag">
        github-workflow
      </a>
    </li>
  
    <li>
      <a href="https://benknoble.github.io/tags#ruby" class="tag">
        ruby
      </a>
    </li>
  
    <li>
      <a href="https://benknoble.github.io/tags#ci" class="tag">
        ci
      </a>
    </li>
  
    <li>
      <a href="https://benknoble.github.io/tags#dotfiles" class="tag">
        dotfiles
      </a>
    </li>
  
</ul>

<div id="post-categories">
  <h4>Categories:
  
    <a href="/categories/#blog">Blog</a>
    
  
  </h4>
</div>

<div id="disqus_thread"></div>
<div class="load-comments" onclick="load_comments(this)">Load Comments</div>
<script>
  var disqus_shortname = 'https-benknoble-github-io';
  var disqus_config = function () {
    this.page.url = "https://benknoble.github.io/blog/2019/08/13/github-actions-ruby/";
    this.page.identifier = "/blog/2019/08/13/github-actions-ruby";
  };

  function load_comments(div) {
    var d = document, s = d.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    div.parentNode.removeChild(div)
  };
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


<div id="post-navigation">
  
  <span id="previous">
    <a href="https://benknoble.github.io/blog/2019/07/31/studying/"
      title="Effective Study Habits">
      Previous</a>
  </span>
  
  
  <span id="next">
    <a href="https://benknoble.github.io/blog/2019/08/14/cstat-efficiencies/"
       title="Efficient Shell—Git Commit Statistics">
      Next</a>
  </span>
  
</div>
<div id="back-to-posts">
  <a href="/categories/#ruby-where-are-you-in-github-workflows">
    Back to posts</a>
</div>

    </section>
    <footer>
<hr/>
  <ul>
    
    <li>
      <a href="https://benknoble.github.io/">Home</a>
    </li>
    
    <li>
      <a href="https://benknoble.github.io/contact/">Contact</a>
    </li>
    
    <li>
      <a href="https://benknoble.github.io/sitemap.xml">Sitemap</a>
    </li>
    
    <li>
      <a href="https://benknoble.github.io/feed.xml">RSS Feed</a>
    </li>
    
    <li>
      <a href="https://benknoble.github.io/colophon/">Colophon</a>
    </li>
    
    <li>
      <a href="https://github.com/benknoble/benknoble.github.io/blob/master/LICENSE">Copyright D. Ben Knoble</a>
    </li>
    
    <li>
      <a href="https://www.goatcounter.com">No personal information collected</a>
    </li>
    
    <li>
      <p xmlns:cc="http://creativecommons.org/ns#" ><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-NC-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a></p>
    </li>
  </ul>
</footer>

    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    <script>
      (function() {
        var script = document.createElement('script');
        window.counter = 'https://benknoble_github_io.goatcounter.com/count'
        script.async = 1;
        script.src = '//gc.zgo.at/count.js';

        var ins = document.getElementsByTagName('script')[0];
        ins.parentNode.insertBefore(script, ins)
      })();
    </script>
  </body>
</html>
